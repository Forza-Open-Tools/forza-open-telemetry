<script setup lang="ts">
import { computed } from 'vue';
import { TelemetryDataPoint } from '../lib/data';
import { CarCorner } from '../lib/types';
import { formatAsPercent } from '../lib/utils';

const props = defineProps<{
  data: TelemetryDataPoint;
  corner: CarCorner;
}>();

const level = computed(() => {
  if (props.corner === CarCorner.frontLeft) return props.data.suspensionTravel.normalized.front.left;
  if (props.corner === CarCorner.frontRight) return props.data.suspensionTravel.normalized.front.right;
  if (props.corner === CarCorner.rearLeft) return props.data.suspensionTravel.normalized.rear.left;
  return props.data.suspensionTravel.normalized.rear.right;
});

function getColor(value: number) {
  const percent = value * 100;
  if (percent < 20 || percent > 80) return 'bg-red-500';
  return 'bg-green-400';
}

const spring = computed(() => ({
  style: { height: formatAsPercent(level.value) },
  class: getColor(level.value),
  label: formatAsPercent(level.value),
}));
</script>
<template>
  <div class="spring-label">{{ spring.label }}</div>
  <div class="spring">
    <div class="spring-level" :class="spring.class" :style="spring.style" />
  </div>
</template>

<style>
.spring {
  @apply w-[20px]
    h-[175px]
    border
    border-black
    relative
    mx-4;
}

.spring-label {
  @apply text-sm
    h-[175px]
    w-10
    flex
    items-center;
}

.spring-level {
  @apply absolute
    bottom-0
    left-0
    w-full
    bg-red-700;
}
</style>
